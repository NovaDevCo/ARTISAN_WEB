{% extends "base.html" %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='user_blog.css') }}" />
{% endblock %}

{% block content %}
<h2 class="blog-title">{{ user.username }}'s Blog</h2>
<div class="blog-feed">
  {% for post in posts %}
    <article class="blog-card">
      <a href="{{ url_for('views.blog_detail', post_id=post.id) }}" class="blog-card-link">
        <div class="blog-card-body">
          <h4>{{ post.title }}</h4>
          <p>{{ post.description }}</p>

          {% if post.media_url %}
            {% if post.media_url.endswith(('.jpg', '.jpeg', '.png', '.gif')) %}
              <img src="{{ url_for('static', filename=post.media_url) }}" alt="{{ post.title }}" class="blog-media"/>
            {% elif post.media_url.endswith(('.mp4', '.mov', '.avi', '.webm')) %}
              <video controls preload="metadata" class="blog-media">
                <source src="{{ url_for('static', filename=post.media_url) }}">
                Your browser does not support the video tag.
              </video>
            {% endif %}
          {% endif %}

          <small>Posted on {{ post.created_at.strftime('%Y-%m-%d %H:%M') }}</small>
        </div>
      </a>
    </article>
  {% else %}
    <p class="empty-state">No posts yet. <a href="{{ url_for('views.new_blog_post') }}">Create one</a>!</p>
  {% endfor %}
</div>
{% endblock %}
