{% extends "base.html" %}

{% block extra_css %}
  <link rel="stylesheet" href="{{ url_for('static', filename='shop_rating.css') }}?v=2">
{% endblock %}

{% block content %}
<div class="shop-page">
  <h2>{{ shop.name }}</h2>
  <p>{{ shop.description }}</p>

  {% if avg_rating %}
    <div class="rating-section">
      <p>
        Average Rating:
        <span class="rating-stars">
          {% for i in range(avg_rating|round(0, 'floor')|int) %}
            ‚≠ê
          {% endfor %}
        </span>
        <span class="rating-text">({{ "%.1f"|format(avg_rating) }})</span>
      </p>
    </div>
  {% else %}
    <p class="no-ratings">No ratings yet.</p>
  {% endif %}
  <hr>

  {% if eligible_order %}
    <div class="rating-form">
      <form method="POST" action="{{ url_for('views.rate_shop_user', shop_id=shop.shop_id) }}">
        {{ form.hidden_tag() }}
        <div class="form-group">
          <label for="{{ form.value.id }}">Rate your experience:</label><br> 
          {{ form.value(class="form-control") }}
        </div>
        <button type="submit" class="btn btn-primary">Submit Rating</button>
      </form>
    </div>
  {% else %}
    <p class="text-warning">You can rate this shop after receiving an order.</p>
  {% endif %}
</div>
{% endblock %}